{% extends 'scheduler/base.html' %}

{% block content %}
<div class="container mx-auto px-4 py-6">
    <div class="bg-white rounded-lg shadow-md p-6">
        <div class="flex flex-col md:flex-row md:items-start">
            <!-- Left: Barbershop Info -->
            <div class="md:w-1/2 mb-6 md:mb-0">
                <img id="imageUrl" alt="Business Image" class="w-full h-64 object-cover rounded-md shadow">
                <div class="mt-6">
                    <h1 class="text-3xl font-bold text-gray-800 mb-4" id="businessName">Business Name</h1>
                    <p class="text-lg text-gray-600"><strong>Address:</strong> <span id="address">123 Barbershop Street</span></p>
                    <p class="text-lg text-gray-600"><strong>Email:</strong> <span id="email">barber@shop.com</span></p>
                    <p class="text-lg text-gray-600"><strong>Phone:</strong> <span id="phone">123-456-7890</span></p>
                    <p class="text-lg text-gray-600"><strong>Service:</strong> <span id="service">Haircut, Shaving</span></p>
                </div>
            </div>

            <!-- Right: Booking Options -->
            <div class="md:w-1/2 md:pl-10">
                <div class="bg-gray-50 p-6 rounded-lg shadow-md">
                    <h2 class="text-2xl font-bold text-gray-800 mb-4">Book a Service</h2>
                    <p class="text-lg text-gray-600 mb-4">Choose a date and time for your appointment:</p>
                    <form id="bookingForm">
                        <div class="mb-4">
                            <label for="bookingDate" class="block text-gray-600">Select Date</label>
                            <input type="date" id="bookingDate" class="w-full p-2 border border-gray-300 rounded-lg">
                        </div>
                        <div class="mb-4">
                            <label for="bookingTime" class="block text-gray-600">Select Time</label>
                            <input type="time" id="bookingTime" class="w-full p-2 border border-gray-300 rounded-lg">
                        </div>
                        <button type="submit" class="w-full bg-indigo-600 text-white font-semibold py-2 px-4 rounded-lg shadow hover:bg-indigo-500 transition-colors">Confirm Booking</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-app.js";
    import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore.js";

    // Firebase configuration (same as in schedule.html and dashboard.html)
    const firebaseConfig = {
        apiKey: "AIzaSyDdn3sQrXDz9lGzmCsU7sIfazS56K4ScLI",
        authDomain: "barbershop-77353.firebaseapp.com",
        projectId: "barbershop-77353",
        storageBucket: "barbershop-77353.appspot.com",
        messagingSenderId: "1018170430611",
        appId: "1:1018170430611:web:3667f5a317d34e0e2ea966",
        measurementId: "G-4VS048B47G"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    // Function to fetch barbershop data
    async function fetchBarbershopData(barbershopId) {
        try {
            const docRef = doc(db, 'businesses', barbershopId);
            const docSnap = await getDoc(docRef);
            if (docSnap.exists()) {
                const data = docSnap.data();
                document.getElementById('businessName').innerText = data.business_name;
                document.getElementById('address').innerText = data.address;
                document.getElementById('email').innerText = data.email;
                document.getElementById('phone').innerText = data.phone;
                document.getElementById('service').innerText = data.service;
                document.getElementById('imageUrl').src = data.image_url || 'https://via.placeholder.com/600x300';
            } else {
                console.error('No such document!');
            }
        } catch (e) {
            console.error("Error fetching barbershop data:", e);
        }
    }

    document.addEventListener('DOMContentLoaded', () => {
        const barbershopId = "{{ barbershop_id }}"; // This ID should be passed from the URL or context
        if (barbershopId) {
            fetchBarbershopData(barbershopId);
        } else {
            console.error("Barbershop ID not provided.");
        }
    });
</script>
{% endblock %}
